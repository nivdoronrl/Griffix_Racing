<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cart — Griffix Racing</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Archivo+Narrow:ital,wght@0,400;0,500;0,600;0,700;1,400&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            charcoal: { DEFAULT: '#2B2B2B', 700: '#353535', 800: '#1E1E1E', 900: '#141414' },
            lime: { DEFAULT: '#D4FF00', dark: '#B8DE00' },
            tan: { DEFAULT: '#A39171', dark: '#7D6E56' }
          },
          fontFamily: {
            display: ['Oswald', 'sans-serif'],
            body: ['Archivo Narrow', 'sans-serif'],
          }
        }
      }
    }
  </script>
  <link rel="stylesheet" href="/shared/theme.css">
</head>
<body>

<div id="nav-placeholder"></div>

<!-- ── Page Hero ─────────────────────────────────────────────────────────── -->
<section class="page-hero topo" style="padding-top:64px;">
  <div class="absolute inset-0" style="background:radial-gradient(ellipse 70% 100% at 50% 120%, rgba(163,145,113,.12) 0%, transparent 60%);"></div>
  <div class="relative z-10 max-w-7xl mx-auto px-6 py-14">
    <div class="label mb-3">Your Selection</div>
    <h1 class="font-display font-bold text-white" style="font-size:clamp(36px,6vw,72px); letter-spacing:-.03em; line-height:.95;">YOUR CART</h1>
  </div>
</section>

<!-- ── Cart Content ───────────────────────────────────────────────────────── -->
<section style="padding:56px 0 96px; background:#0f0f0f; min-height:40vh;">
  <div class="max-w-7xl mx-auto px-6">

    <!-- Empty state -->
    <div id="cart-empty" style="display:none; text-align:center; padding:80px 0;">
      <svg width="56" height="56" fill="none" stroke="#333" stroke-width="1.5" viewBox="0 0 24 24" style="margin:0 auto 20px;"><path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>
      <p class="font-display text-[#444] text-2xl mb-2">YOUR CART IS EMPTY</p>
      <p class="text-[#555]" style="font-family:'Archivo Narrow',sans-serif;">No kits yet — find the one that fits your ride.</p>
      <a href="/shop.html" class="btn-primary inline-block mt-8 no-underline" style="font-size:14px; padding:14px 32px;">Browse Shop</a>
    </div>

    <!-- Cart content -->
    <div id="cart-content" style="display:none;">
      <div class="lg:grid lg:grid-cols-3 lg:gap-10">

        <!-- Items (2/3) -->
        <div class="lg:col-span-2">
          <div class="flex items-center justify-between mb-6">
            <h2 class="font-display text-white font-bold text-lg tracking-wide">ITEMS</h2>
            <button id="clear-cart-btn" class="text-[#444] text-xs hover:text-[#D4FF00] transition-colors duration-200 underline" style="font-family:'Archivo Narrow',sans-serif;">Clear cart</button>
          </div>

          <div id="cart-items-full"></div>
        </div>

        <!-- Order Summary (1/3) -->
        <div>
          <div style="background:#181818; border:1px solid rgba(163,145,113,.2); padding:28px; position:sticky; top:88px;">
            <h2 class="font-display text-white font-bold text-base tracking-widest uppercase mb-6">Order Summary</h2>

            <div class="space-y-3 mb-6">
              <div class="flex justify-between text-sm" style="font-family:'Archivo Narrow',sans-serif;">
                <span class="text-[#666]">Subtotal (<span id="summary-count">0</span> item<span id="summary-plural">s</span>)</span>
                <span class="text-[#e5e5e5]">$<span id="summary-subtotal">0.00</span></span>
              </div>
              <div class="flex justify-between text-sm" style="font-family:'Archivo Narrow',sans-serif;">
                <span class="text-[#666]">Shipping</span>
                <span class="text-[#666]">Calculated at checkout</span>
              </div>
            </div>

            <div style="border-top:1px solid rgba(163,145,113,.2); padding-top:20px; margin-bottom:24px;" class="flex justify-between items-baseline">
              <span class="font-display text-white font-bold text-sm tracking-wider uppercase">Total</span>
              <span class="font-display font-bold" style="font-size:26px; color:#D4FF00;">$<span id="summary-total">0.00</span></span>
            </div>

            <a href="/checkout.html" id="checkout-btn" class="btn-primary block text-center no-underline mb-3" style="padding:16px; font-size:14px;">Proceed to Checkout →</a>
            <a href="/shop.html" class="block text-center text-[#555] text-xs hover:text-[#D4FF00] transition-colors duration-200 no-underline" style="font-family:'Archivo Narrow',sans-serif;">← Continue Shopping</a>

            <!-- Trust signals -->
            <div style="border-top:1px solid rgba(255,255,255,.05); margin-top:24px; padding-top:20px;" class="space-y-3">
              <div class="flex items-center gap-3">
                <svg width="16" height="16" fill="none" stroke="#A39171" stroke-width="2" viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                <span class="text-[#555] text-xs" style="font-family:'Archivo Narrow',sans-serif;">Secure checkout</span>
              </div>
              <div class="flex items-center gap-3">
                <svg width="16" height="16" fill="none" stroke="#A39171" stroke-width="2" viewBox="0 0 24 24"><rect x="1" y="3" width="15" height="13"/><polygon points="16 8 20 8 23 11 23 16 16 16 16 8"/><circle cx="5.5" cy="18.5" r="2.5"/><circle cx="18.5" cy="18.5" r="2.5"/></svg>
                <span class="text-[#555] text-xs" style="font-family:'Archivo Narrow',sans-serif;">48hr dispatch</span>
              </div>
              <div class="flex items-center gap-3">
                <svg width="16" height="16" fill="none" stroke="#A39171" stroke-width="2" viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg>
                <span class="text-[#555] text-xs" style="font-family:'Archivo Narrow',sans-serif;">Free shipping on orders $150+</span>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</section>

<div id="footer-placeholder"></div>

<script src="/js/reveal.js"></script>
<script src="/js/cart.js"></script>
<script src="/js/nav.js"></script>
<script>
function renderCartPage() {
  const items = window.Cart.getItems();
  const emptyEl = document.getElementById('cart-empty');
  const contentEl = document.getElementById('cart-content');

  if (items.length === 0) {
    emptyEl.style.display = 'block';
    contentEl.style.display = 'none';
    return;
  }

  emptyEl.style.display = 'none';
  contentEl.style.display = 'block';

  // Render items
  const listEl = document.getElementById('cart-items-full');
  listEl.innerHTML = items.map(item => `
    <div style="display:flex; gap:16px; padding:20px 0; border-bottom:1px solid rgba(255,255,255,.06); align-items:flex-start;" data-id="${item.id}">
      <div style="flex-shrink:0;">
        <img src="${item.image || 'https://placehold.co/88x88/1a1a1a/444?text=Kit'}" alt="${item.name}"
          style="width:88px; height:88px; object-fit:cover; border:1px solid #222;">
      </div>
      <div style="flex:1; min-width:0;">
        <div class="font-display text-white font-bold" style="font-size:16px; letter-spacing:.02em; margin-bottom:3px;">${item.name}</div>
        ${item.make ? `<div style="color:#555; font-family:'Archivo Narrow',sans-serif; font-size:12px; margin-bottom:10px;">${item.make} ${item.model || ''} ${item.year || ''}</div>` : '<div style="margin-bottom:10px;"></div>'}
        <div style="display:flex; align-items:center; gap:16px; flex-wrap:wrap;">
          <div class="qty-stepper">
            <button class="qty-btn" data-action="dec" data-id="${item.id}">−</button>
            <span class="qty-display">${item.qty}</span>
            <button class="qty-btn" data-action="inc" data-id="${item.id}">+</button>
          </div>
          <button data-remove="${item.id}" style="background:none; border:none; color:#444; font-family:'Archivo Narrow',sans-serif; font-size:12px; cursor:pointer; text-decoration:underline; padding:0;" class="hover:text-[#D4FF00] transition-colors duration-200">Remove</button>
        </div>
      </div>
      <div class="font-display font-bold" style="font-size:20px; color:#D4FF00; flex-shrink:0;">$${(item.price * item.qty).toFixed(2)}</div>
    </div>
  `).join('');

  // Qty buttons
  listEl.querySelectorAll('.qty-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const id = btn.dataset.id;
      const curr = window.Cart.getItems().find(i => i.id === id);
      if (!curr) return;
      if (btn.dataset.action === 'inc') window.Cart.updateQty(id, curr.qty + 1);
      else window.Cart.updateQty(id, curr.qty - 1);
    });
  });

  // Remove buttons
  listEl.querySelectorAll('[data-remove]').forEach(btn => {
    btn.addEventListener('click', () => window.Cart.removeItem(btn.dataset.remove));
  });

  // Summary
  const count = window.Cart.getCount();
  const subtotal = window.Cart.getSubtotal();
  document.getElementById('summary-count').textContent = count;
  document.getElementById('summary-plural').textContent = count === 1 ? '' : 's';
  document.getElementById('summary-subtotal').textContent = subtotal.toFixed(2);
  document.getElementById('summary-total').textContent = subtotal.toFixed(2);
}

// Listen for cart updates
window.addEventListener('griffix:cart-updated', renderCartPage);
// Initial render (wait for cart.js to init)
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', renderCartPage);
} else {
  setTimeout(renderCartPage, 0);
}

// Clear cart
document.getElementById('clear-cart-btn')?.addEventListener('click', () => {
  if (confirm('Remove all items from your cart?')) window.Cart.clear();
});
</script>
</body>
</html>
