<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Login — Griffix Racing</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Archivo+Narrow:wght@400;500;600&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            lime: { DEFAULT: '#D4FF00' },
            tan: { DEFAULT: '#A39171' }
          },
          fontFamily: {
            display: ['Oswald', 'sans-serif'],
            body: ['Archivo Narrow', 'sans-serif'],
          }
        }
      }
    }
  </script>
  <link rel="stylesheet" href="/shared/theme.css">
</head>
<body style="min-height:100vh; display:flex; align-items:center; justify-content:center; background:#0a0a0a;">
<div class="carbon absolute inset-0" style="opacity:.15;"></div>
<div class="absolute inset-0" style="background:radial-gradient(ellipse 60% 60% at 50% 50%, rgba(163,145,113,.08) 0%, transparent 60%);"></div>

<div class="relative z-10" style="width:100%; max-width:420px; padding:20px;">
  <div style="text-align:center; margin-bottom:36px;">
    <img src="/brand_assets/Griffix logo.png" alt="Griffix Racing" class="logo-lime" style="height:44px; margin:0 auto 12px;">
    <div style="font-family:'Oswald',sans-serif; font-size:11px; font-weight:600; letter-spacing:.16em; color:#444; text-transform:uppercase;">Admin Panel</div>
  </div>

  <div style="background:#181818; border:1px solid rgba(163,145,113,.2); padding:36px;">
    <h1 class="font-display text-white font-bold mb-6" style="font-size:22px; letter-spacing:-.01em; text-align:center;">SIGN IN</h1>

    <form id="login-form">
      <label class="field-label">Password</label>
      <input id="password" type="password" class="form-input mb-4" placeholder="Enter admin password" autofocus>
      <div id="login-error" style="display:none; color:#c0a0a0; font-family:'Archivo Narrow',sans-serif; font-size:13px; margin-bottom:14px;"></div>
      <button type="submit" id="login-btn" class="btn-primary w-full" style="padding:14px; font-size:14px;">Sign In</button>
    </form>
  </div>

  <p style="text-align:center; margin-top:20px; font-family:'Archivo Narrow',sans-serif; font-size:12px; color:#333;">
    <a href="/index.html" style="color:#444; text-decoration:none; hover:color:#D4FF00;">← Back to site</a>
  </p>
</div>

<script type="module">
import { saveToken } from '/js/admin-auth.js';

document.getElementById('login-form').addEventListener('submit', async (e) => {
  e.preventDefault();
  const btn = document.getElementById('login-btn');
  const errorEl = document.getElementById('login-error');
  const password = document.getElementById('password').value;

  btn.disabled = true;
  btn.textContent = 'Signing in…';
  errorEl.style.display = 'none';

  try {
    const res = await fetch('/api/admin/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ password }),
    });
    const data = await res.json();

    if (!res.ok || !data.token) {
      throw new Error(data.error || 'Incorrect password.');
    }

    saveToken(data.token);
    window.location.href = '/admin/orders.html';
  } catch (err) {
    btn.disabled = false;
    btn.textContent = 'Sign In';
    errorEl.textContent = err.message;
    errorEl.style.display = 'block';
  }
});
</script>
</body>
</html>
